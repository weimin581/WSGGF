1. run demo_smoothing.m can obtain results of Fig. 4 (g) and Fig. 4 (h) in our paper.
2. run demo_adjustment_adjust.m can obtain results of Fig. 7 (g) and Fig. 7 (h) in our paper.


Image filtering under guidance image, known as guided filtering (GF), has been successfully applied to a variety of applications. Existing GF methods utilize either conventional full window-based framework (FWF) or simple uniformly weighted aggregation strategy (UWA); thereby they suffer from edge-blurring. In this paper, based upon gradient guided filtering (GGF), a weighted side-window based gradient guided filtering (WSGGF) is proposed to address the aforementioned problem. First, both regression and adaptive regularization terms in GGF are improved upon eight side windows by introduction of side window-based framework (SWF). L_1 norm is adopted to choose the results calculated in side windows. Second, the UWA strategy in GGF is replaced by a refined variance-based weighted average (VWA) aggregation. In VWA, the value of each weight is chosen inversely proportional to the corresponding estimator. We show that with these improvements our method can better retain the edge sharpness and is more robust to visual artifacts. To cut down the time consumption, a fast version of WSGGF (FWSGGF) is proposed by incorporating a simple but effective down-sampling strategy, which is about four times faster while maintaining the superior performance. By comparing with the state-of-the-art (SOTA) methods on edge-aware smoothing, detail enhancement, high dynamic range image (HDR) compression, image luminance adjustment, depth map upsampling and single image haze removal, the effectiveness and flexibility of our proposed methods are verified. 